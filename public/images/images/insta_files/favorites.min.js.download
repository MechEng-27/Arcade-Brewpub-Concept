var Favorites;function favorites_after_button_submit(t,e,o,a){}function favorites_after_initial_load(t){}(Favorites=Favorites||{}).Utilities=function(){var t=this,e=jQuery;t.isFavorite=function(t,o){var a=!1;return e.each(o,(function(e,o){o.post_id===parseInt(t)&&(a=!0),parseInt(o.post_id)===t&&(a=!0)})),a},t.objectLength=function(t){var e,o=0;for(e in t)t.hasOwnProperty(e)&&o++;return o},t.siteIndex=function(t){for(var e=0;e<Favorites.userFavorites.length;e++)if(Favorites.userFavorites[e].site_id===parseInt(t))return e},t.getThumbnail=function(t,e){var o=t.thumbnails;if(void 0===o||0==o.length)return!1;var a=o[e];return void 0!==a&&(a||!1)}},(Favorites=Favorites||{}).Formatter=function(){var t=jQuery;this.addFavoriteCount=function(t,e){return Favorites.jsData.button_options.include_count?(e<=0&&(e=0),t+=' <span class="simplefavorite-button-count">'+e+"</span>"):t},this.decrementAllCounts=function(){for(var e=t(".simplefavorite-button.active.has-count"),o=0;o<e.length;o++){var a=t(e)[o],i=t(a).find(".simplefavorite-button-count"),s=t(i).text()-1;t(a).attr("data-favoritecount",s)}}},(Favorites=Favorites||{}).ButtonOptionsFormatter=function(){var t=this,e=jQuery;t.options=Favorites.jsData.button_options,t.formatter=new Favorites.Formatter,t.format=function(e,o){t.options.custom_colors&&t.colors(e,o),t.html(e,o)},t.html=function(o,a){var i=e(o).attr("data-favoritecount"),s=t.options.button_type,n="";return"custom"===t.options.button_type?(a&&e(o).html(t.formatter.addFavoriteCount(Favorites.jsData.favorited,i)),a||e(o).html(t.formatter.addFavoriteCount(Favorites.jsData.favorite,i)),t.applyIconColor(o,a),void t.applyCountColor(o,a)):a?(n+='<i class="'+s.icon_class+'"></i> ',n+=s.state_active,void e(o).html(t.formatter.addFavoriteCount(n,i))):(n+='<i class="'+s.icon_class+'"></i> ',n+=s.state_default,e(o).html(t.formatter.addFavoriteCount(n,i)),t.applyIconColor(o,a),void t.applyCountColor(o,a))},t.colors=function(o,a){if(t.options.custom_colors){var i;if(a)return(i=t.options.active).background_active&&e(o).css("background-color",i.background_active),i.border_active&&e(o).css("border-color",i.border_active),void(i.text_active&&e(o).css("color",i.text_active));(i=t.options.default).background_default&&e(o).css("background-color",i.background_default),i.border_default&&e(o).css("border-color",i.border_default),i.text_default&&e(o).css("color",i.text_default),t.boxShadow(o)}},t.boxShadow=function(o){t.options.box_shadow||(e(o).css("box-shadow","none"),e(o).css("-webkit-box-shadow","none"),e(o).css("-moz-box-shadow","none"))},t.applyIconColor=function(o,a){t.options.custom_colors&&(a&&t.options.active.icon_active&&e(o).find("i").css("color",t.options.active.icon_active),!a&&t.options.default.icon_default&&e(o).find("i").css("color",t.options.default.icon_default))},t.applyCountColor=function(o,a){t.options.custom_colors&&(a&&t.options.active.count_active?e(o).find(Favorites.selectors.count).css("color",t.options.active.count_active):!a&&t.options.default.count_default&&e(o).find(Favorites.selectors.count).css("color",t.options.default.count_default))}},(Favorites=Favorites||{}).UserFavorites=function(){var t=this,e=jQuery;return t.initialLoad=!1,t.bindEvents=function(){e(window).on("load",(function(){t.initialLoad=!0,t.getFavorites()}))},t.getFavorites=function(){e.ajax({url:Favorites.jsData.ajaxurl,type:"POST",datatype:"json",data:{action:Favorites.formActions.favoritesarray},success:function(o){Favorites.jsData.dev_mode&&(console.log("The current user favorites were successfully loaded."),console.log(o)),Favorites.userFavorites=o.favorites,e(document).trigger("favorites-user-favorites-loaded",[o.favorites,t.initialLoad]),e(document).trigger("favorites-update-all-buttons"),t.initialLoad&&favorites_after_initial_load(Favorites.userFavorites)},error:function(t){Favorites.jsData.dev_mode&&(console.log("The was an error loading the user favorites."),console.log(t))}})},t.bindEvents()},(Favorites=Favorites||{}).Clear=function(){var t=this,e=jQuery;return t.activeButton,t.utilities=new Favorites.Utilities,t.formatter=new Favorites.Formatter,t.bindEvents=function(){e(document).on("click",Favorites.selectors.clear_button,(function(o){o.preventDefault(),t.activeButton=e(this),t.clearFavorites()})),e(document).on("favorites-updated-single",(function(){t.updateClearButtons()})),e(document).on("favorites-user-favorites-loaded",(function(){t.updateClearButtons()}))},t.clearFavorites=function(){t.loading(!0);var o=e(t.activeButton).attr("data-siteid");e.ajax({url:Favorites.jsData.ajaxurl,type:"post",datatype:"json",data:{action:Favorites.formActions.clearall,siteid:o},success:function(a){Favorites.jsData.dev_mode&&(console.log("Favorites list successfully cleared."),console.log(a)),Favorites.userFavorites=a.favorites,t.formatter.decrementAllCounts(),t.loading(!1),t.clearSiteFavorites(o),e(document).trigger("favorites-cleared",[t.activeButton,a.old_favorites]),e(document).trigger("favorites-update-all-buttons"),location.reload()},error:function(t){Favorites.jsData.dev_mode&&(console.log("There was an error clearing the favorites list."),console.log(t))}})},t.loading=function(o){if(o)return e(t.activeButton).addClass(Favorites.cssClasses.loading),void e(t.activeButton).attr("disabled","disabled");e(t.activeButton).removeClass(Favorites.cssClasses.loading)},t.updateClearButtons=function(){for(var o,a,i=0;i<e(Favorites.selectors.clear_button).length;i++){o=e(Favorites.selectors.clear_button)[i],a=e(o).attr("data-siteid");for(var s=0;s<Favorites.userFavorites.length;s++)Favorites.userFavorites[s].site_id===parseInt(a)&&(t.utilities.objectLength(Favorites.userFavorites[s].posts)>0?e(o).attr("disabled",!1):e(o).attr("disabled","disabled"))}},t.clearSiteFavorites=function(t){e.each(Favorites.userFavorites,(function(e,o){this.site_id===parseInt(t)&&(Favorites.userFavorites[e].posts={})}))},t.bindEvents()},(Favorites=Favorites||{}).Lists=function(){var t=this,e=jQuery;return t.utilities=new Favorites.Utilities,t.buttonFormatter=new Favorites.ButtonOptionsFormatter,t.bindEvents=function(){e(document).on("favorites-update-all-lists",(function(){t.updateAllLists()})),e(document).on("favorites-updated-single",(function(){t.updateAllLists()})),e(document).on("favorites-cleared",(function(){t.updateAllLists()})),e(document).on("favorites-user-favorites-loaded",(function(){t.updateAllLists()}))},t.updateAllLists=function(){if(void 0!==Favorites.userFavorites)for(var o=0;o<Favorites.userFavorites.length;o++)for(var a=e(Favorites.selectors.list+'[data-siteid="'+Favorites.userFavorites[o].site_id+'"]'),i=0;i<e(a).length;i++){var s=e(a)[i];t.updateSingleList(s)}},t.updateSingleList=function(o){var a=e(o).attr("data-userid"),i=e(o).attr("data-siteid"),s=e(o).attr("data-includelinks"),n=e(o).attr("data-includebuttons"),r=e(o).attr("data-includethumbnails"),c=e(o).attr("data-thumbnailsize"),d=e(o).attr("data-includeexcerpts"),u=e(o).attr("data-posttypes"),v=e(o).attr("data-nofavoritestext");e.ajax({url:Favorites.jsData.ajaxurl,type:"post",dataType:"json",data:{action:Favorites.formActions.favoritelist,userid:a,siteid:i,include_links:s,include_buttons:n,include_thumbnails:r,thumbnail_size:c,include_excerpt:d,no_favorites:v,post_types:u},success:function(a){Favorites.jsData.dev_mode&&(console.log("Favorites list successfully retrieved."),console.log(e(o)),console.log(a));var i=e(a.list);e(o).replaceWith(i),t.removeButtonLoading(i),e(document).trigger("favorites-list-updated",[i])},error:function(t){Favorites.jsData.dev_mode&&(console.log("There was an error updating the list."),console.log(o),console.log(t))}})},t.removeButtonLoading=function(o){var a=e(o).find(Favorites.selectors.button);e.each(a,(function(){t.buttonFormatter.format(e(this),!1),e(this).removeClass(Favorites.cssClasses.active),e(this).removeClass(Favorites.cssClasses.loading)}))},t.removeInvalidListItems=function(o,a){var i=e(o).find("li[data-postid]");e.each(i,(function(o,i){var s=e(this).attr("data-postid");t.utilities.isFavorite(s,a)||e(this).remove()}))},t.bindEvents()},(Favorites=Favorites||{}).Button=function(){var t=this,e=jQuery;return t.activeButton,t.allButtons,t.authenticated=!0,t.formatter=new Favorites.Formatter,t.data={},t.bindEvents=function(){e(document).on("click",Favorites.selectors.button,(function(o){o.preventDefault(),t.activeButton=e(this),t.setAllButtons(),t.submitFavorite()}))},t.setAllButtons=function(){var o=e(t.activeButton).attr("data-postid");t.allButtons=e('button[data-postid="'+o+'"]')},t.setData=function(){t.data.post_id=e(t.activeButton).attr("data-postid"),t.data.site_id=e(t.activeButton).attr("data-siteid"),t.data.status=e(t.activeButton).hasClass("active")?"inactive":"active";var o=e(t.activeButton).attr("data-user-consent-accepted");t.data.user_consent_accepted=void 0!==o&&""!==o},t.submitFavorite=function(){t.loading(!0),t.setData();var o={action:Favorites.formActions.favorite,postid:t.data.post_id,siteid:t.data.site_id,status:t.data.status,user_consent_accepted:t.data.user_consent_accepted};e.ajax({url:Favorites.jsData.ajaxurl,type:"post",dataType:"json",data:o,success:function(o){return Favorites.jsData.dev_mode&&(console.log("The favorite was successfully saved."),console.log(o)),"unauthenticated"===o.status?(Favorites.authenticated=!1,t.loading(!1),t.data.status="inactive",e(document).trigger("favorites-update-all-buttons"),void e(document).trigger("favorites-require-authentication",[t.data])):"consent_required"===o.status?(t.loading(!1),void e(document).trigger("favorites-require-consent",[o,t.data,t.activeButton])):(Favorites.userFavorites=o.favorites,t.loading(!1),t.resetButtons(),e(document).trigger("favorites-updated-single",[o.favorites,t.data.post_id,t.data.site_id,t.data.status]),e(document).trigger("favorites-update-all-buttons"),void favorites_after_button_submit(o.favorites,t.data.post_id,t.data.site_id,t.data.status))},error:function(t){Favorites.jsData.dev_mode&&(console.log("There was an error saving the favorite."),console.log(t))}})},t.resetButtons=function(){var o=parseInt(e(t.activeButton).attr("data-favoritecount"));e.each(t.allButtons,(function(){if("inactive"===t.data.status)return o<=0&&(o=1),e(this).removeClass(Favorites.cssClasses.active),e(this).attr("data-favoritecount",o-1),void e(this).find(Favorites.selectors.count).text(o-1);e(this).addClass(Favorites.cssClasses.active),e(this).attr("data-favoritecount",o+1),e(this).find(Favorites.selectors.count).text(o+1)}))},t.loading=function(o){o?e.each(t.allButtons,(function(){e(this).attr("disabled","disabled"),e(this).addClass(Favorites.cssClasses.loading),e(this).html(t.addLoadingIndication())})):e.each(t.allButtons,(function(){e(this).attr("disabled",!1),e(this).removeClass(Favorites.cssClasses.loading)}))},t.addLoadingIndication=function(e){return"1"!==Favorites.jsData.indicate_loading?e:"active"===t.data.status?Favorites.jsData.loading_text+Favorites.jsData.loading_image_active:Favorites.jsData.loading_text+Favorites.jsData.loading_image},t.bindEvents()},(Favorites=Favorites||{}).ButtonUpdater=function(){var t=this,e=jQuery;return t.utilities=new Favorites.Utilities,t.formatter=new Favorites.Formatter,t.buttonFormatter=new Favorites.ButtonOptionsFormatter,t.activeButton,t.data={},t.bindEvents=function(){e(document).on("favorites-update-all-buttons",(function(){t.updateAllButtons()})),e(document).on("favorites-list-updated",(function(e,o){t.updateAllButtons(o)}))},t.updateAllButtons=function(o){if(void 0!==Favorites.userFavorites)for(var a=void 0===typeof o&&""!==o?e(o).find(Favorites.selectors.button):e(Favorites.selectors.button),i=0;i<e(a).length;i++)t.activeButton=e(a)[i],Favorites.authenticated&&t.setButtonData(),Favorites.authenticated&&t.utilities.isFavorite(t.data.postid,t.data.site_favorites)?(t.buttonFormatter.format(e(t.activeButton),!0),e(t.activeButton).addClass(Favorites.cssClasses.active),e(t.activeButton).removeClass(Favorites.cssClasses.loading),e(t.activeButton).find(Favorites.selectors.count).text(t.data.favorite_count)):(t.buttonFormatter.format(e(t.activeButton),!1),e(t.activeButton).removeClass(Favorites.cssClasses.active),e(t.activeButton).removeClass(Favorites.cssClasses.loading),e(t.activeButton).find(Favorites.selectors.count).text(t.data.favorite_count))},t.setButtonData=function(){t.data.postid=e(t.activeButton).attr("data-postid"),t.data.siteid=e(t.activeButton).attr("data-siteid"),t.data.favorite_count=e(t.activeButton).attr("data-favoritecount"),t.data.site_index=t.utilities.siteIndex(t.data.siteid),t.data.site_favorites=Favorites.userFavorites[t.data.site_index].posts,t.data.favorite_count<=0&&(t.data.favorite_count=0)},t.bindEvents()},(Favorites=Favorites||{}).TotalCount=function(){var t=this,e=jQuery;return t.bindEvents=function(){e(document).on("favorites-updated-single",(function(){t.updateTotal()})),e(document).on("favorites-cleared",(function(){t.updateTotal()})),e(document).on("favorites-user-favorites-loaded",(function(){t.updateTotal()}))},t.updateTotal=function(){for(var t=0;t<e(Favorites.selectors.total_favorites).length;t++){for(var o=e(Favorites.selectors.total_favorites)[t],a=parseInt(e(o).attr("data-siteid")),i=e(o).attr("data-posttypes").split(","),s=0,n=0;n<Favorites.userFavorites.length;n++){var r=Favorites.userFavorites[n];r.site_id===a&&e.each(r.posts,(function(){"all"!==e(o).attr("data-posttypes")?-1!==e.inArray(this.post_type,i)&&s++:s++}))}e(o).text(s)}},t.bindEvents()},(Favorites=Favorites||{}).PostFavoriteCount=function(){var t=this,e=jQuery;return t.bindEvents=function(){e(document).on("favorites-updated-single",(function(e,o,a,i,s){if("active"===s)return t.updateCounts();t.decrementSingle(a,i)})),e(document).on("favorites-cleared",(function(e,o,a){t.updateCounts(a,!0)}))},t.updateCounts=function(t,o){void 0!==t&&""!==t||(t=Favorites.userFavorites),void 0!==o&&""!==o||(o=!1);for(var a=0;a<e("["+Favorites.selectors.post_favorite_count+"]").length;a++){var i=e("["+Favorites.selectors.post_favorite_count+"]")[a],s=parseInt(e(i).attr(Favorites.selectors.post_favorite_count)),n=e(i).attr("data-siteid");""===n&&(n="1");for(var r=0;r<t.length;r++){var c=t[r];c.site_id===parseInt(n)&&e.each(c.posts,(function(){if(this.post_id===s){if(o){var t=parseInt(this.total)-1;return void e(i).text(t)}e(i).text(this.total)}}))}}},t.decrementSingle=function(t,o){for(var a=0;a<e("["+Favorites.selectors.post_favorite_count+"]").length;a++){var i=e("["+Favorites.selectors.post_favorite_count+"]")[a],s=e(i).attr(Favorites.selectors.post_favorite_count),n=e(i).attr("data-siteid");if(""===n&&(n="1"),n===o&&s===t){var r=parseInt(e(i).text())-1;e(i).text(r)}}},t.bindEvents()},(Favorites=Favorites||{}).RequireAuthentication=function(){var t=this,e=jQuery;return t.bindEvents=function(){e(document).on("favorites-require-authentication",(function(){Favorites.jsData.dev_mode&&console.log("Unauthenticated user was prevented from favoriting."),Favorites.jsData.authentication_redirect?t.redirect():t.openModal()})),e(document).on("click",".simplefavorites-modal-backdrop",(function(e){t.closeModal()})),e(document).on("click","["+Favorites.selectors.close_modals+"]",(function(e){e.preventDefault(),t.closeModal()}))},t.redirect=function(){window.location=Favorites.jsData.authentication_redirect_url},t.openModal=function(){t.buildModal(),setTimeout((function(){e("["+Favorites.selectors.modals+"]").addClass("active")}),10)},t.buildModal=function(){if(!(e("["+Favorites.selectors.modals+"]").length>0)){var t='<div class="simplefavorites-modal-backdrop" '+Favorites.selectors.modals+"></div>";t+='<div class="simplefavorites-modal-content" '+Favorites.selectors.modals+">",t+='<div class="simplefavorites-modal-content-body">',t+=Favorites.jsData.authentication_modal_content,t+="</div>\x3c!-- .simplefavorites-modal-content-body --\x3e",t+="</div>\x3c!-- .simplefavorites-modal-content --\x3e",e("body").prepend(t)}},t.closeModal=function(){e("["+Favorites.selectors.modals+"]").removeClass("active"),e(document).trigger("favorites-modal-closed")},t.bindEvents()},(Favorites=Favorites||{}).RequireConsent=function(){var t=this,e=jQuery;return t.consentData,t.postData,t.activeButton,t.bindEvents=function(){e(document).on("favorites-require-consent",(function(e,o,a,i){t.consentData=o,t.postData=a,t.activeButton=i,t.openModal()})),e(document).on("favorites-user-consent-approved",(function(o,a){if(void 0!==a)return e(t.activeButton).attr("data-user-consent-accepted","true"),e(t.activeButton).click(),void t.closeModal();t.setConsent(!0)})),e(document).on("favorites-user-consent-denied",(function(){t.setConsent(!1)})),e(document).on("click",".simplefavorites-modal-backdrop",(function(e){t.closeModal()})),e(document).on("click","[data-favorites-consent-deny]",(function(o){o.preventDefault(),t.closeModal(),e(document).trigger("favorites-user-consent-denied")})),e(document).on("click","[data-favorites-consent-accept]",(function(t){t.preventDefault(),e(document).trigger("favorites-user-consent-approved",[e(this)])}))},t.openModal=function(){t.buildModal(),setTimeout((function(){e("["+Favorites.selectors.consentModal+"]").addClass("active")}),10)},t.buildModal=function(){if(!(e("["+Favorites.selectors.consentModal+"]").length>0)){var o='<div class="simplefavorites-modal-backdrop" '+Favorites.selectors.consentModal+"></div>";o+='<div class="simplefavorites-modal-content" '+Favorites.selectors.consentModal+">",o+='<div class="simplefavorites-modal-content-body no-padding">',o+='<div class="simplefavorites-modal-content-interior">',o+=t.consentData.message,o+="</div>",o+='<div class="simplefavorites-modal-content-footer">',o+='<button class="simplefavorites-button-consent-deny" data-favorites-consent-deny>'+t.consentData.deny_text+"</button>",o+='<button class="simplefavorites-button-consent-accept" data-favorites-consent-accept>'+t.consentData.accept_text+"</button>",o+="</div>\x3c!-- .simplefavorites-modal-footer --\x3e",o+="</div>\x3c!-- .simplefavorites-modal-content-body --\x3e",o+="</div>\x3c!-- .simplefavorites-modal-content --\x3e",e("body").prepend(o)}},t.closeModal=function(){e("["+Favorites.selectors.consentModal+"]").removeClass("active")},t.setConsent=function(t){e.ajax({url:Favorites.jsData.ajaxurl,type:"post",dataType:"json",data:{action:Favorites.formActions.cookieConsent,consent:t}})},t.bindEvents()},jQuery(document).ready((function(){new Favorites.Factory})),(Favorites=Favorites||{}).selectors={button:".simplefavorite-button",list:".favorites-list",clear_button:".simplefavorites-clear",total_favorites:".simplefavorites-user-count",modals:"data-favorites-modal",consentModal:"data-favorites-consent-modal",close_modals:"data-favorites-modal-close",count:".simplefavorite-button-count",post_favorite_count:"data-favorites-post-count-id"},Favorites.cssClasses={loading:"loading",active:"active"},Favorites.jsData={ajaxurl:favorites_data.ajaxurl,favorite:favorites_data.favorite,favorited:favorites_data.favorited,include_count:favorites_data.includecount,indicate_loading:favorites_data.indicate_loading,loading_text:favorites_data.loading_text,loading_image_active:favorites_data.loading_image_active,loading_image:favorites_data.loading_image,cache_enabled:favorites_data.cache_enabled,authentication_modal_content:favorites_data.authentication_modal_content,authentication_redirect:favorites_data.authentication_redirect,authentication_redirect_url:favorites_data.authentication_redirect_url,button_options:favorites_data.button_options,dev_mode:favorites_data.dev_mode,logged_in:favorites_data.logged_in,user_id:favorites_data.user_id},Favorites.userFavorites=null,Favorites.authenticated=!0,Favorites.formActions={favoritesarray:"favorites_array",favorite:"favorites_favorite",clearall:"favorites_clear",favoritelist:"favorites_list",cookieConsent:"favorites_cookie_consent"},Favorites.Factory=function(){jQuery;return this.build=function(){new Favorites.UserFavorites,new Favorites.Lists,new Favorites.Clear,new Favorites.Button,new Favorites.ButtonUpdater,new Favorites.TotalCount,new Favorites.PostFavoriteCount,new Favorites.RequireAuthentication,new Favorites.RequireConsent},this.build()};